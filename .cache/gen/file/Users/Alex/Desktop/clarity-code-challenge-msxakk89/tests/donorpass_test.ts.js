import { Clarinet } from 'https://deno.land/x/clarinet@v1.3.0/index.ts';
import { assertEquals } from 'https://deno.land/std@0.90.0/testing/asserts.ts';
import { launch, pledge } from "../helpers/clearfund.ts";
import { getLastTokenId, mint, transfer, getOwner, getTokenUri } from "../helpers/donorpass.ts";
// tests for transfer functions
Clarinet.test({
    name: "transfer: a user cannot transfer nft if they do not own one",
    async fn (chain, accounts) {
        const sender = accounts.get("deployer").address;
        const receiver = accounts.get("wallet_1").address;
        const minedBlock = chain.mineBlock([
            transfer(sender, receiver, 0)
        ]);
        assertEquals(minedBlock.height, 2);
        minedBlock.receipts[0].result.expectErr().expectUint(3);
    }
});
Clarinet.test({
    name: "transfer: a user cannot transfer nft to themselves",
    async fn (chain, accounts) {
        const deployer = accounts.get("deployer").address;
        const wallet1 = accounts.get("wallet_1").address;
        const wallet2 = accounts.get("wallet_2").address;
        // minting the donorpass
        chain.mineBlock([
            launch(wallet1)
        ]);
        chain.mineEmptyBlockUntil(40);
        chain.mineBlock([
            pledge(wallet2)
        ]);
        const minedBlock = chain.mineBlock([
            transfer(wallet2, wallet2, 1)
        ]);
        assertEquals(minedBlock.height, 42);
        minedBlock.receipts[0].result.expectErr().expectUint(2);
    }
});
Clarinet.test({
    name: "transfer: a user should be able transfer nft successfully to another recipient",
    async fn (chain, accounts) {
        const deployer = accounts.get("deployer").address;
        const wallet1 = accounts.get("wallet_1").address;
        const wallet2 = accounts.get("wallet_2").address;
        const wallet3 = accounts.get("wallet_3").address;
        // minting the donorpass
        const def = chain.mineBlock([
            launch(wallet1)
        ]);
        chain.mineEmptyBlockUntil(40);
        const abc = chain.mineBlock([
            pledge(wallet2)
        ]);
        // console.log(abc)
        const minedBlock = chain.mineBlock([
            transfer(wallet2, wallet3, 1)
        ]);
        // console.log(minedBlock)
        assertEquals(minedBlock.height, 42);
        minedBlock.receipts[0].result.expectOk().expectBool(true);
        const theAssetsMaps = chain.getAssetsMaps();
        assertEquals(theAssetsMaps.assets[".donorpass.donorpass"][wallet2], 0);
        assertEquals(theAssetsMaps.assets[".donorpass.donorpass"][wallet3], 1);
    }
});
// tests for mint functions
Clarinet.test({
    name: "mint: a user cannot mint the nft if it is not the clearfund contract",
    async fn (chain, accounts) {
        const deployer = accounts.get("deployer").address;
        const wallet1 = accounts.get("wallet_1").address;
        const responseWhenNothingIsMinted = getLastTokenId(chain, deployer);
        assertEquals(responseWhenNothingIsMinted.result, `(ok u0)`);
        const minedBlock = chain.mineBlock([
            mint(deployer, wallet1)
        ]);
        assertEquals(minedBlock.height, 2);
        minedBlock.receipts[0].result.expectErr().expectUint(100);
        const theAssetsMaps = chain.getAssetsMaps();
        const investorNFTCount = theAssetsMaps.assets[".donorpass.donorpass"];
        assertEquals(investorNFTCount, undefined);
    }
});
Clarinet.test({
    name: "mint: only the clearfund contract can mint the nft",
    async fn (chain, accounts) {
        const deployer = accounts.get("deployer").address;
        const wallet1 = accounts.get("wallet_1").address;
        const wallet2 = accounts.get("wallet_2").address;
        assertEquals(getLastTokenId(chain, deployer).result, `(ok u0)`);
        chain.mineBlock([
            launch(wallet1)
        ]);
        chain.mineEmptyBlockUntil(40);
        chain.mineBlock([
            pledge(wallet2)
        ]);
        // console.log(chain)
        assertEquals(getLastTokenId(chain, deployer).result, `(ok u1)`);
        const theAssetsMaps = chain.getAssetsMaps();
        // console.log(theAssetsMaps)
        const investorNFTCount = theAssetsMaps.assets[".donorpass.donorpass"][wallet2];
        assertEquals(investorNFTCount, 1);
    }
});
// // tests for readonly functions
Clarinet.test({
    name: "get-last-token-id: a user is able to read the last nft id minted",
    async fn (chain, accounts) {
        const deployer = accounts.get("deployer").address;
        const wallet1 = accounts.get("wallet_1").address;
        const wallet2 = accounts.get("wallet_2").address;
        const wallet3 = accounts.get("wallet_3").address;
        assertEquals(getLastTokenId(chain, deployer).result, `(ok u0)`);
        chain.mineBlock([
            launch(wallet1)
        ]);
        chain.mineEmptyBlockUntil(40);
        chain.mineBlock([
            pledge(wallet2)
        ]);
        chain.mineBlock([
            pledge(wallet2)
        ]);
        chain.mineBlock([
            pledge(wallet3)
        ]);
        chain.mineBlock([
            pledge(wallet3)
        ]);
        assertEquals(getLastTokenId(chain, deployer).result, `(ok u4)`);
    }
});
Clarinet.test({
    name: "get-owner: a user is able to read the owner of the nft",
    async fn (chain, accounts) {
        const deployer = accounts.get("deployer").address;
        const wallet1 = accounts.get("wallet_1").address;
        const wallet2 = accounts.get("wallet_2").address;
        const wallet3 = accounts.get("wallet_3").address;
        chain.mineBlock([
            launch(wallet1)
        ]);
        chain.mineEmptyBlockUntil(40);
        chain.mineBlock([
            pledge(wallet2)
        ]);
        chain.mineBlock([
            pledge(wallet3)
        ]);
        assertEquals(getOwner(chain, deployer, 1).result, `(ok (some ${wallet2}))`);
        assertEquals(getOwner(chain, deployer, 2).result, `(ok (some ${wallet3}))`);
    }
});
Clarinet.test({
    name: "get-token-uri: a user is able to read the owner of the nft",
    async fn (chain, accounts) {
        const deployer = accounts.get("deployer").address;
        const wallet1 = accounts.get("wallet_1").address;
        const wallet2 = accounts.get("wallet_2").address;
        chain.mineBlock([
            launch(wallet1)
        ]);
        chain.mineEmptyBlockUntil(40);
        chain.mineBlock([
            pledge(wallet2)
        ]);
        assertEquals(getTokenUri(chain, deployer, 1).result, `(ok none)`);
    }
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImZpbGU6Ly8vVXNlcnMvQWxleC9EZXNrdG9wL2NsYXJpdHktY29kZS1jaGFsbGVuZ2UtbXN4YWtrODkvdGVzdHMvZG9ub3JwYXNzX3Rlc3QudHMiXSwic291cmNlc0NvbnRlbnQiOlsiXG5pbXBvcnQgeyBDbGFyaW5ldCwgVHgsIENoYWluLCBBY2NvdW50LCB0eXBlcyB9IGZyb20gJ2h0dHBzOi8vZGVuby5sYW5kL3gvY2xhcmluZXRAdjEuMy4wL2luZGV4LnRzJztcbmltcG9ydCB7IGFzc2VydEVxdWFscyB9IGZyb20gJ2h0dHBzOi8vZGVuby5sYW5kL3N0ZEAwLjkwLjAvdGVzdGluZy9hc3NlcnRzLnRzJztcbmltcG9ydCB7IGxhdW5jaCwgcGxlZGdlIH0gZnJvbSBcIi4uL2hlbHBlcnMvY2xlYXJmdW5kLnRzXCJcbmltcG9ydCB7IGdldExhc3RUb2tlbklkLCBtaW50LCB0cmFuc2ZlciwgZ2V0T3duZXIsIGdldFRva2VuVXJpIH0gZnJvbSBcIi4uL2hlbHBlcnMvZG9ub3JwYXNzLnRzXCJcblxuLy8gdGVzdHMgZm9yIHRyYW5zZmVyIGZ1bmN0aW9uc1xuQ2xhcmluZXQudGVzdCh7XG4gICAgbmFtZTogXCJ0cmFuc2ZlcjogYSB1c2VyIGNhbm5vdCB0cmFuc2ZlciBuZnQgaWYgdGhleSBkbyBub3Qgb3duIG9uZVwiLFxuICAgIGFzeW5jIGZuKGNoYWluOiBDaGFpbiwgYWNjb3VudHM6IE1hcDxzdHJpbmcsIEFjY291bnQ+KSB7XG4gICAgICAgIGNvbnN0IHNlbmRlciA9IGFjY291bnRzLmdldChcImRlcGxveWVyXCIpIS5hZGRyZXNzXG4gICAgICAgIGNvbnN0IHJlY2VpdmVyID0gYWNjb3VudHMuZ2V0KFwid2FsbGV0XzFcIikhLmFkZHJlc3NcblxuICAgICAgICBjb25zdCBtaW5lZEJsb2NrID0gY2hhaW4ubWluZUJsb2NrKFt0cmFuc2ZlcihzZW5kZXIsIHJlY2VpdmVyLCAwKV0pXG5cbiAgICAgICAgYXNzZXJ0RXF1YWxzKG1pbmVkQmxvY2suaGVpZ2h0LCAyKVxuICAgICAgICBtaW5lZEJsb2NrLnJlY2VpcHRzWzBdLnJlc3VsdC5leHBlY3RFcnIoKS5leHBlY3RVaW50KDMpXG4gICAgfVxufSlcblxuQ2xhcmluZXQudGVzdCh7XG4gICAgbmFtZTogXCJ0cmFuc2ZlcjogYSB1c2VyIGNhbm5vdCB0cmFuc2ZlciBuZnQgdG8gdGhlbXNlbHZlc1wiLFxuICAgIGFzeW5jIGZuKGNoYWluOiBDaGFpbiwgYWNjb3VudHM6IE1hcDxzdHJpbmcsIEFjY291bnQ+KSB7XG4gICAgICAgIGNvbnN0IGRlcGxveWVyID0gYWNjb3VudHMuZ2V0KFwiZGVwbG95ZXJcIikhLmFkZHJlc3NcbiAgICAgICAgY29uc3Qgd2FsbGV0MSA9IGFjY291bnRzLmdldChcIndhbGxldF8xXCIpIS5hZGRyZXNzXG4gICAgICAgIGNvbnN0IHdhbGxldDIgPSBhY2NvdW50cy5nZXQoXCJ3YWxsZXRfMlwiKSEuYWRkcmVzc1xuXG4gICAgICAgIC8vIG1pbnRpbmcgdGhlIGRvbm9ycGFzc1xuICAgICAgICBjaGFpbi5taW5lQmxvY2soWyBsYXVuY2god2FsbGV0MSkgXSlcbiAgICAgICAgY2hhaW4ubWluZUVtcHR5QmxvY2tVbnRpbCg0MClcbiAgICAgICAgY2hhaW4ubWluZUJsb2NrKFsgcGxlZGdlKHdhbGxldDIpIF0pXG5cbiAgICAgICAgY29uc3QgbWluZWRCbG9jayA9IGNoYWluLm1pbmVCbG9jayhbdHJhbnNmZXIod2FsbGV0Miwgd2FsbGV0MiwgMSldKVxuXG4gICAgICAgIGFzc2VydEVxdWFscyhtaW5lZEJsb2NrLmhlaWdodCwgNDIpXG4gICAgICAgIG1pbmVkQmxvY2sucmVjZWlwdHNbMF0ucmVzdWx0LmV4cGVjdEVycigpLmV4cGVjdFVpbnQoMilcbiAgICB9XG59KVxuXG5DbGFyaW5ldC50ZXN0KHtcbiAgICBuYW1lOiBcInRyYW5zZmVyOiBhIHVzZXIgc2hvdWxkIGJlIGFibGUgdHJhbnNmZXIgbmZ0IHN1Y2Nlc3NmdWxseSB0byBhbm90aGVyIHJlY2lwaWVudFwiLFxuICAgIGFzeW5jIGZuKGNoYWluOiBDaGFpbiwgYWNjb3VudHM6IE1hcDxzdHJpbmcsIEFjY291bnQ+KSB7XG4gICAgICAgIGNvbnN0IGRlcGxveWVyID0gYWNjb3VudHMuZ2V0KFwiZGVwbG95ZXJcIikhLmFkZHJlc3NcbiAgICAgICAgY29uc3Qgd2FsbGV0MSA9IGFjY291bnRzLmdldChcIndhbGxldF8xXCIpIS5hZGRyZXNzXG4gICAgICAgIGNvbnN0IHdhbGxldDIgPSBhY2NvdW50cy5nZXQoXCJ3YWxsZXRfMlwiKSEuYWRkcmVzc1xuICAgICAgICBjb25zdCB3YWxsZXQzID0gYWNjb3VudHMuZ2V0KFwid2FsbGV0XzNcIikhLmFkZHJlc3NcblxuICAgICAgICAvLyBtaW50aW5nIHRoZSBkb25vcnBhc3NcbiAgICAgICAgY29uc3QgZGVmID0gY2hhaW4ubWluZUJsb2NrKFsgbGF1bmNoKHdhbGxldDEpIF0pXG5cbiAgICAgICAgY2hhaW4ubWluZUVtcHR5QmxvY2tVbnRpbCg0MClcbiAgICAgICAgY29uc3QgYWJjID0gY2hhaW4ubWluZUJsb2NrKFsgcGxlZGdlKHdhbGxldDIpIF0pXG4gICAgICAgIC8vIGNvbnNvbGUubG9nKGFiYylcbiAgICAgICAgY29uc3QgbWluZWRCbG9jayA9IGNoYWluLm1pbmVCbG9jayhbdHJhbnNmZXIod2FsbGV0Miwgd2FsbGV0MywgMSldKVxuICAgICAgICAvLyBjb25zb2xlLmxvZyhtaW5lZEJsb2NrKVxuICAgICAgICBhc3NlcnRFcXVhbHMobWluZWRCbG9jay5oZWlnaHQsIDQyKVxuICAgICAgICBtaW5lZEJsb2NrLnJlY2VpcHRzWzBdLnJlc3VsdC5leHBlY3RPaygpLmV4cGVjdEJvb2wodHJ1ZSlcblxuICAgICAgICBjb25zdCB0aGVBc3NldHNNYXBzID0gY2hhaW4uZ2V0QXNzZXRzTWFwcygpXG4gICAgICAgIGFzc2VydEVxdWFscyh0aGVBc3NldHNNYXBzLmFzc2V0c1tcIi5kb25vcnBhc3MuZG9ub3JwYXNzXCJdW3dhbGxldDJdLCAwKVxuICAgICAgICBhc3NlcnRFcXVhbHModGhlQXNzZXRzTWFwcy5hc3NldHNbXCIuZG9ub3JwYXNzLmRvbm9ycGFzc1wiXVt3YWxsZXQzXSwgMSlcbiAgICB9XG59KVxuXG4vLyB0ZXN0cyBmb3IgbWludCBmdW5jdGlvbnNcbkNsYXJpbmV0LnRlc3Qoe1xuICAgIG5hbWU6IFwibWludDogYSB1c2VyIGNhbm5vdCBtaW50IHRoZSBuZnQgaWYgaXQgaXMgbm90IHRoZSBjbGVhcmZ1bmQgY29udHJhY3RcIixcbiAgICBhc3luYyBmbihjaGFpbjogQ2hhaW4sIGFjY291bnRzOiBNYXA8c3RyaW5nLCBBY2NvdW50Pikge1xuICAgICAgICBjb25zdCBkZXBsb3llciA9IGFjY291bnRzLmdldChcImRlcGxveWVyXCIpIS5hZGRyZXNzXG4gICAgICAgIGNvbnN0IHdhbGxldDEgPSBhY2NvdW50cy5nZXQoXCJ3YWxsZXRfMVwiKSEuYWRkcmVzc1xuXG4gICAgICAgIGNvbnN0IHJlc3BvbnNlV2hlbk5vdGhpbmdJc01pbnRlZCA9IGdldExhc3RUb2tlbklkKGNoYWluLCBkZXBsb3llcilcbiAgICAgICAgYXNzZXJ0RXF1YWxzKHJlc3BvbnNlV2hlbk5vdGhpbmdJc01pbnRlZC5yZXN1bHQsIGAob2sgdTApYClcblxuICAgICAgICBjb25zdCBtaW5lZEJsb2NrID0gY2hhaW4ubWluZUJsb2NrKFtcbiAgICAgICAgICAgIG1pbnQoZGVwbG95ZXIsIHdhbGxldDEpXG4gICAgICAgIF0pXG5cbiAgICAgICAgYXNzZXJ0RXF1YWxzKG1pbmVkQmxvY2suaGVpZ2h0LCAyKVxuICAgICAgICBtaW5lZEJsb2NrLnJlY2VpcHRzWzBdLnJlc3VsdC5leHBlY3RFcnIoKS5leHBlY3RVaW50KDEwMClcblxuICAgICAgICBjb25zdCB0aGVBc3NldHNNYXBzID0gY2hhaW4uZ2V0QXNzZXRzTWFwcygpXG4gICAgICAgIFxuICAgICAgICBjb25zdCBpbnZlc3Rvck5GVENvdW50ID0gdGhlQXNzZXRzTWFwcy5hc3NldHNbXCIuZG9ub3JwYXNzLmRvbm9ycGFzc1wiXVxuICAgICAgICBhc3NlcnRFcXVhbHMoaW52ZXN0b3JORlRDb3VudCwgdW5kZWZpbmVkKVxuICAgIH0sXG59KTtcblxuQ2xhcmluZXQudGVzdCh7XG4gICAgbmFtZTogXCJtaW50OiBvbmx5IHRoZSBjbGVhcmZ1bmQgY29udHJhY3QgY2FuIG1pbnQgdGhlIG5mdFwiLFxuICAgIGFzeW5jIGZuKGNoYWluOiBDaGFpbiwgYWNjb3VudHM6IE1hcDxzdHJpbmcsIEFjY291bnQ+KSB7XG4gICAgICAgIGNvbnN0IGRlcGxveWVyID0gYWNjb3VudHMuZ2V0KFwiZGVwbG95ZXJcIikhLmFkZHJlc3NcbiAgICAgICAgY29uc3Qgd2FsbGV0MSA9IGFjY291bnRzLmdldChcIndhbGxldF8xXCIpIS5hZGRyZXNzXG4gICAgICAgIGNvbnN0IHdhbGxldDIgPSBhY2NvdW50cy5nZXQoXCJ3YWxsZXRfMlwiKSEuYWRkcmVzc1xuXG4gICAgICAgIGFzc2VydEVxdWFscyhnZXRMYXN0VG9rZW5JZChjaGFpbiwgZGVwbG95ZXIpLnJlc3VsdCwgYChvayB1MClgKVxuXG4gICAgICAgIGNoYWluLm1pbmVCbG9jayhbIGxhdW5jaCh3YWxsZXQxKSBdKVxuICAgICAgICBjaGFpbi5taW5lRW1wdHlCbG9ja1VudGlsKDQwKVxuICAgICAgICBjaGFpbi5taW5lQmxvY2soWyBwbGVkZ2Uod2FsbGV0MikgXSlcbiAgICAgICAgLy8gY29uc29sZS5sb2coY2hhaW4pXG4gICAgICAgIGFzc2VydEVxdWFscyhnZXRMYXN0VG9rZW5JZChjaGFpbiwgZGVwbG95ZXIpLnJlc3VsdCwgYChvayB1MSlgKVxuXG4gICAgICAgIGNvbnN0IHRoZUFzc2V0c01hcHMgPSBjaGFpbi5nZXRBc3NldHNNYXBzKClcbiAgICAgICAgLy8gY29uc29sZS5sb2codGhlQXNzZXRzTWFwcylcbiAgICAgICAgY29uc3QgaW52ZXN0b3JORlRDb3VudCA9IHRoZUFzc2V0c01hcHMuYXNzZXRzW1wiLmRvbm9ycGFzcy5kb25vcnBhc3NcIl1bd2FsbGV0Ml1cbiAgICAgICAgYXNzZXJ0RXF1YWxzKGludmVzdG9yTkZUQ291bnQsIDEpXG4gICAgfVxufSk7XG5cbi8vIC8vIHRlc3RzIGZvciByZWFkb25seSBmdW5jdGlvbnNcblxuQ2xhcmluZXQudGVzdCh7XG4gICAgbmFtZTogXCJnZXQtbGFzdC10b2tlbi1pZDogYSB1c2VyIGlzIGFibGUgdG8gcmVhZCB0aGUgbGFzdCBuZnQgaWQgbWludGVkXCIsXG4gICAgYXN5bmMgZm4oY2hhaW46IENoYWluLCBhY2NvdW50czogTWFwPHN0cmluZywgQWNjb3VudD4pIHtcbiAgICAgICAgY29uc3QgZGVwbG95ZXIgPSBhY2NvdW50cy5nZXQoXCJkZXBsb3llclwiKSEuYWRkcmVzc1xuICAgICAgICBjb25zdCB3YWxsZXQxID0gYWNjb3VudHMuZ2V0KFwid2FsbGV0XzFcIikhLmFkZHJlc3NcbiAgICAgICAgY29uc3Qgd2FsbGV0MiA9IGFjY291bnRzLmdldChcIndhbGxldF8yXCIpIS5hZGRyZXNzXG4gICAgICAgIGNvbnN0IHdhbGxldDMgPSBhY2NvdW50cy5nZXQoXCJ3YWxsZXRfM1wiKSEuYWRkcmVzc1xuXG4gICAgICAgIGFzc2VydEVxdWFscyhnZXRMYXN0VG9rZW5JZChjaGFpbiwgZGVwbG95ZXIpLnJlc3VsdCwgYChvayB1MClgKVxuXG4gICAgICAgIGNoYWluLm1pbmVCbG9jayhbIGxhdW5jaCh3YWxsZXQxKSBdKVxuICAgICAgICBjaGFpbi5taW5lRW1wdHlCbG9ja1VudGlsKDQwKVxuICAgICAgICBjaGFpbi5taW5lQmxvY2soWyBwbGVkZ2Uod2FsbGV0MikgXSlcbiAgICAgICAgY2hhaW4ubWluZUJsb2NrKFsgcGxlZGdlKHdhbGxldDIpIF0pXG4gICAgICAgIGNoYWluLm1pbmVCbG9jayhbIHBsZWRnZSh3YWxsZXQzKSBdKVxuICAgICAgICBjaGFpbi5taW5lQmxvY2soWyBwbGVkZ2Uod2FsbGV0MykgXSlcblxuICAgICAgICBhc3NlcnRFcXVhbHMoZ2V0TGFzdFRva2VuSWQoY2hhaW4sIGRlcGxveWVyKS5yZXN1bHQsIGAob2sgdTQpYClcbiAgICB9XG59KVxuXG5DbGFyaW5ldC50ZXN0KHtcbiAgICBuYW1lOiBcImdldC1vd25lcjogYSB1c2VyIGlzIGFibGUgdG8gcmVhZCB0aGUgb3duZXIgb2YgdGhlIG5mdFwiLFxuICAgIGFzeW5jIGZuKGNoYWluOiBDaGFpbiwgYWNjb3VudHM6IE1hcDxzdHJpbmcsIEFjY291bnQ+KSB7XG4gICAgICAgIGNvbnN0IGRlcGxveWVyID0gYWNjb3VudHMuZ2V0KFwiZGVwbG95ZXJcIikhLmFkZHJlc3NcbiAgICAgICAgY29uc3Qgd2FsbGV0MSA9IGFjY291bnRzLmdldChcIndhbGxldF8xXCIpIS5hZGRyZXNzXG4gICAgICAgIGNvbnN0IHdhbGxldDIgPSBhY2NvdW50cy5nZXQoXCJ3YWxsZXRfMlwiKSEuYWRkcmVzc1xuICAgICAgICBjb25zdCB3YWxsZXQzID0gYWNjb3VudHMuZ2V0KFwid2FsbGV0XzNcIikhLmFkZHJlc3NcblxuICAgICAgICBjaGFpbi5taW5lQmxvY2soWyBsYXVuY2god2FsbGV0MSkgXSlcbiAgICAgICAgY2hhaW4ubWluZUVtcHR5QmxvY2tVbnRpbCg0MClcbiAgICAgICAgY2hhaW4ubWluZUJsb2NrKFsgcGxlZGdlKHdhbGxldDIpIF0pXG4gICAgICAgIGNoYWluLm1pbmVCbG9jayhbIHBsZWRnZSh3YWxsZXQzKSBdKVxuXG4gICAgICAgIGFzc2VydEVxdWFscyhnZXRPd25lcihjaGFpbiwgZGVwbG95ZXIsIDEpLnJlc3VsdCwgYChvayAoc29tZSAke3dhbGxldDJ9KSlgKVxuICAgICAgICBhc3NlcnRFcXVhbHMoZ2V0T3duZXIoY2hhaW4sIGRlcGxveWVyLCAyKS5yZXN1bHQsIGAob2sgKHNvbWUgJHt3YWxsZXQzfSkpYClcblxuICAgIH1cbn0pXG5cbkNsYXJpbmV0LnRlc3Qoe1xuICAgIG5hbWU6IFwiZ2V0LXRva2VuLXVyaTogYSB1c2VyIGlzIGFibGUgdG8gcmVhZCB0aGUgb3duZXIgb2YgdGhlIG5mdFwiLFxuICAgIGFzeW5jIGZuKGNoYWluOiBDaGFpbiwgYWNjb3VudHM6IE1hcDxzdHJpbmcsIEFjY291bnQ+KSB7XG4gICAgICAgIGNvbnN0IGRlcGxveWVyID0gYWNjb3VudHMuZ2V0KFwiZGVwbG95ZXJcIikhLmFkZHJlc3NcbiAgICAgICAgY29uc3Qgd2FsbGV0MSA9IGFjY291bnRzLmdldChcIndhbGxldF8xXCIpIS5hZGRyZXNzXG4gICAgICAgIGNvbnN0IHdhbGxldDIgPSBhY2NvdW50cy5nZXQoXCJ3YWxsZXRfMlwiKSEuYWRkcmVzc1xuXG4gICAgICAgIGNoYWluLm1pbmVCbG9jayhbIGxhdW5jaCh3YWxsZXQxKSBdKVxuICAgICAgICBjaGFpbi5taW5lRW1wdHlCbG9ja1VudGlsKDQwKVxuICAgICAgICBjaGFpbi5taW5lQmxvY2soWyBwbGVkZ2Uod2FsbGV0MikgXSlcblxuICAgICAgICBhc3NlcnRFcXVhbHMoZ2V0VG9rZW5VcmkoY2hhaW4sIGRlcGxveWVyLCAxKS5yZXN1bHQsIGAob2sgbm9uZSlgKVxuXG4gICAgfVxufSlcbiJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFDQSxTQUFTLFFBQVEsUUFBbUMsOENBQThDLENBQUM7QUFDbkcsU0FBUyxZQUFZLFFBQVEsaURBQWlELENBQUM7QUFDL0UsU0FBUyxNQUFNLEVBQUUsTUFBTSxRQUFRLHlCQUF5QixDQUFBO0FBQ3hELFNBQVMsY0FBYyxFQUFFLElBQUksRUFBRSxRQUFRLEVBQUUsUUFBUSxFQUFFLFdBQVcsUUFBUSx5QkFBeUIsQ0FBQTtBQUUvRiwrQkFBK0I7QUFDL0IsUUFBUSxDQUFDLElBQUksQ0FBQztJQUNWLElBQUksRUFBRSw2REFBNkQ7SUFDbkUsTUFBTSxFQUFFLEVBQUMsS0FBWSxFQUFFLFFBQThCLEVBQUU7UUFDbkQsTUFBTSxNQUFNLEdBQUcsUUFBUSxDQUFDLEdBQUcsQ0FBQyxVQUFVLENBQUMsQ0FBRSxPQUFPO1FBQ2hELE1BQU0sUUFBUSxHQUFHLFFBQVEsQ0FBQyxHQUFHLENBQUMsVUFBVSxDQUFDLENBQUUsT0FBTztRQUVsRCxNQUFNLFVB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